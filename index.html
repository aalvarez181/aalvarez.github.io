<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Electronics Inventory</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    *{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif}
    body{
      background:#f5f5f5;
      color:#222;
      min-height:100vh;
      display:flex;
      justify-content:center;
      padding:1rem
    }
    .app{
      width:100%;
      max-width:1000px;
      background:#fff;
      border-radius:6px;
      padding:1rem 1.25rem 1.25rem;
      border:1px solid #ddd;
      box-shadow:0 2px 6px rgba(0,0,0,.05);
      display:flex;
      flex-direction:column;
      gap:1rem
    }
    header{
      display:flex;
      flex-wrap:wrap;
      justify-content:space-between;
      gap:.5rem;
      align-items:baseline;
      border-bottom:1px solid #e0e0e0;
      padding-bottom:.5rem
    }
    header h1{font-size:1.3rem;font-weight:600}
    header p{font-size:.9rem;color:#555}
    .layout{
      display:grid;
      grid-template-columns:minmax(0,1.2fr) minmax(0,1.8fr);
      gap:1rem
    }
    @media(max-width:800px){.layout{grid-template-columns:1fr}}
    .card{
      background:#fafafa;
      border-radius:4px;
      padding:.75rem;
      border:1px solid #e0e0e0
    }
    .card-title{font-size:1rem;font-weight:600;margin-bottom:.5rem}
    .pill-list{
      list-style:none;
      padding-left:0;
      margin-bottom:.75rem;
      font-size:.85rem;
      color:#444;
      display:flex;
      flex-wrap:wrap;
      gap:.35rem .7rem
    }
    form{display:flex;flex-direction:column;gap:.75rem;margin-top:.25rem}
    .field-row{display:flex;gap:.6rem;flex-wrap:wrap}
    .field{flex:1 1 150px;display:flex;flex-direction:column;gap:.25rem;min-width:0}
    label{font-size:.85rem;color:#444}
    select,input{
      background:#fff;
      border-radius:3px;
      border:1px solid #ccc;
      color:#222;
      font-size:.9rem;
      padding:.4rem .45rem;
      outline:none;
      transition:border-color .15s ease,box-shadow .15s ease
    }
    select:focus,input:focus{
      border-color:#1976d2;
      box-shadow:0 0 0 1px rgba(25,118,210,.2)
    }
    button{
      padding:.45rem .9rem;
      border-radius:3px;
      border:1px solid #1976d2;
      font-size:.9rem;
      cursor:pointer;
      background:#1976d2;
      color:#fff;
      display:inline-flex;
      align-items:center;
      gap:.35rem;
      transition:background-color .15s ease,transform .1s ease
    }
    button:hover{background:#1565c0;transform:translateY(-1px)}
    button:active{transform:translateY(0)}
    .error{font-size:.8rem;color:#c62828;min-height:1rem}
    .result-highlight{
      margin-top:.5rem;
      padding:.5rem .6rem;
      border-radius:3px;
      background:#e3f2fd;
      border:1px solid #bbdefb;
      font-size:.9rem;
      display:none;
      opacity:0;
      transform:translateY(3px);
      transition:opacity .25s ease,transform .25s ease
    }
    .result-highlight.visible{display:block;opacity:1;transform:translateY(0)}
    table{
      width:100%;
      border-collapse:collapse;
      margin-top:.5rem;
      font-size:.8rem
    }
    thead{background:#eceff1}
    th,td{
      text-align:left;
      padding:.35rem .45rem;
      border-bottom:1px solid #e0e0e0;
      white-space:nowrap
    }
    th{font-weight:600;font-size:.8rem}
    tbody tr:nth-child(even){background:#f9f9f9}
    tbody tr:hover{background:#e3f2fd}
    .table-wrapper{
      max-height:260px;
      overflow:auto;
      border-radius:3px;
      border:1px solid #e0e0e0;
      margin-top:.3rem
    }
    .tips{
      list-style:disc;
      padding-left:1.1rem;
      margin-top:.4rem;
      font-size:.8rem;
      color:#555;
      display:flex;
      flex-direction:column;
      gap:.2rem
    }
    .recent-searches{
      list-style:none;
      display:flex;
      flex-wrap:wrap;
      gap:.35rem;
      margin-top:.4rem;
      font-size:.8rem
    }
    .recent-searches li{
      padding:.15rem .45rem;
      border-radius:16px;
      background:#fff;
      border:1px dashed #b0bec5;
      cursor:pointer
    }
    .recent-searches li:hover{border-style:solid}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Electronics Inventory</h1>
      <p>Search drawers by type and value/serial.</p>
    </header>

    <div class="layout">
      <!-- LEFT: FORM + INFO -->
      <section class="card">
        <div class="card-title">Search</div>

        <ul class="pill-list">
          <li>Resistors</li>
          <li>Capacitors</li>
          <li>Potentiometers</li>
          <li>ICs</li>
          <li>Transistors</li>
          <li>Diodes</li>
        </ul>

        <form id="search-form">
          <div class="field-row">
            <div class="field">
              <label for="type">Component type</label>
              <select id="type" required>
                <option value="">Select type…</option>
                <option value="resistor">Resistor</option>
                <option value="capacitor">Capacitor</option>
                <option value="potentiometer">Potentiometer</option>
                <option value="integrated circuit">Integrated Circuit</option>
                <option value="transistor">Transistor</option>
                <option value="diode">Diode</option>
              </select>
            </div>

            <div class="field">
              <label for="query">Value / Serial</label>
              <input id="query" type="text" placeholder="e.g. 10k, 100n, 555, 1N4148" autocomplete="off" />
            </div>
          </div>

          <button type="submit"> Find drawer</button>
          <div id="error" class="error"></div>
        </form>

        <div id="result-highlight" class="result-highlight"></div>

        <ul class="tips">
          <li>Resistors, capacitors, potentiometers → search by <strong>value</strong>.</li>
          <li>ICs, transistors, diodes → search by <strong>serial</strong>.</li>
          <li>Search is case-insensitive and matches substrings.</li>
        </ul>

        <div style="margin-top:0.5rem;">
          <strong style="font-size:0.85rem;">Recent searches</strong>
          <ul id="recent-searches" class="recent-searches"></ul>
        </div>
      </section>

      <!-- RIGHT: TABLE -->
      <section class="card">
        <div class="card-title">Matching Components</div>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Type</th>
                <th>Drawer</th>
                <th>Value / Serial</th>
              </tr>
            </thead>
            <tbody id="results-body"></tbody>
          </table>
        </div>
      </section>
    </div>
  </div>

  <script>
    const TYPE_KEY_MAP = {
      "resistor": "resistors",
      "capacitor": "capacitors",
      "potentiometer": "potentiometers",
      "integrated circuit": "integrated_circuits",
      "transistor": "transistors",
      "diode": "diodes"
    };
    const VALUE_TYPES = new Set(["resistor","capacitor","potentiometer"]);

    let inventoryData = null;

    const form = document.getElementById("search-form");
    const typeSelect = document.getElementById("type");
    const queryInput = document.getElementById("query");
    const errorBox = document.getElementById("error");
    const resultsBody = document.getElementById("results-body");
    const resultHighlight = document.getElementById("result-highlight");
    const recentSearchesList = document.getElementById("recent-searches");
    const recentSearches = [];

    async function loadInventory(){
      try{
        const res = await fetch("electronics.json");
        if(!res.ok) throw new Error("Failed to load electronics.json");
        inventoryData = await res.json();
      }catch(err){
        console.error(err);
        errorBox.textContent = "Error loading electronics.json.";
      }
    }
    loadInventory();

    function addRecentSearch(type,query){
      const label = `${type} – "${query}"`;
      const i = recentSearches.indexOf(label);
      if(i !== -1) recentSearches.splice(i,1);
      recentSearches.unshift(label);
      if(recentSearches.length>6) recentSearches.pop();
      renderRecentSearches();
    }

    function renderRecentSearches(){
      recentSearchesList.innerHTML = "";
      recentSearches.forEach(label=>{
        const li = document.createElement("li");
        li.textContent = label;
        li.onclick = ()=>{
          const [t,qPart] = label.split("–");
          typeSelect.value = t.trim();
          queryInput.value = qPart.replace(/["]/g,"").trim();
          form.dispatchEvent(new Event("submit"));
        };
        recentSearchesList.appendChild(li);
      });
    }

    function validateForm(){
      errorBox.textContent = "";
      const type = typeSelect.value;
      const query = queryInput.value.trim();
      if(!type){
        errorBox.textContent = "Please select a component type.";
        return null;
      }
      if(!query){
        errorBox.textContent = "Please enter a value or serial.";
        return null;
      }
      if(!inventoryData){
        errorBox.textContent = "Inventory data not loaded yet.";
        return null;
      }
      return {type,query};
    }

    function searchInventory(type,query){
      const key = TYPE_KEY_MAP[type];
      const arr = inventoryData[key] || [];
      const fieldName = VALUE_TYPES.has(type) ? "value" : "serial";
      const q = query.toLowerCase();
      const matches = arr.filter(e=>{
        const v = (e[fieldName] || "").toString().toLowerCase();
        return v.includes(q);
      });
      return {fieldName,matches};
    }

    function renderResults(type,fieldName,matches){
      resultsBody.innerHTML = "";
      matches.forEach(e=>{
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${type}</td>
          <td>${e.drawer}</td>
          <td>${e[fieldName] || ""}</td>
        `;
        resultsBody.appendChild(tr);
      });

      if(matches.length){
        const first = matches[0];
        const label = VALUE_TYPES.has(type) ? "value" : "serial";
        resultHighlight.innerHTML =
          `Drawer <strong>${first.drawer}</strong> has <strong>${type}</strong> with ${label} <strong>${first[fieldName]}</strong>.`;
        resultHighlight.classList.add("visible");
      }else{
        resultHighlight.classList.remove("visible");
        resultHighlight.textContent = "";
      }
    }

    form.addEventListener("submit",e=>{
      e.preventDefault();
      const v = validateForm();
      if(!v) return;
      const {type,query} = v;
      const {fieldName,matches} = searchInventory(type,query);
      renderResults(type,fieldName,matches);
      addRecentSearch(type,query);
    });
  </script>
</body>
</html>

